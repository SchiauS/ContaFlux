# Run as local user 1000
User workleto
Group workleto

# Hide server signature (i.e. Apache version)
ServerSignature Off
ServerTokens Prod

# Set technical contact address
ServerAdmin technical@workleto.com

# Identify the correct IP address from Traefik reverse proxy
RemoteIPHeader X-Real-IP
RemoteIPInternalProxy 10.0.0.0/8
RemoteIPInternalProxy 192.168.0.0/16

# Virtual Host for main and www subdomain
<VirtualHost *:80>
    ServerName www
    DocumentRoot /app/public

    # Allow a maximum request body of 500MiB
    LimitRequestBody 524288000

    # Allow cross-origin requests
    Header set Access-Control-Allow-Origin *

    <Directory "/app/public">
        Options FollowSymLinks
        AllowOverride none
        Require all granted
    </Directory>

    RewriteEngine On

    # If the file doesn't exist in the document root, try the fallback PHP script
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} !-f
    RewriteRule ^(.*)$ /app/public/index.php [L,QSA]
</VirtualHost>
